/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/s2clientprotocol/common_pb2.py:19: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.
  DESCRIPTOR = _descriptor.FileDescriptor(
/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/s2clientprotocol/common_pb2.py:32: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.
  _descriptor.EnumValueDescriptor(
/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/s2clientprotocol/common_pb2.py:26: DeprecationWarning: Call to deprecated create function EnumDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.
  _RACE = _descriptor.EnumDescriptor(
/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/s2clientprotocol/common_pb2.py:76: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.
  _descriptor.FieldDescriptor(
/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/s2clientprotocol/common_pb2.py:69: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.
  _AVAILABLEABILITY = _descriptor.Descriptor(
/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/s2clientprotocol/data_pb2.py:20: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.
  DESCRIPTOR = _descriptor.FileDescriptor(
/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/s2clientprotocol/data_pb2.py:34: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.
  _descriptor.EnumValueDescriptor(
/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/s2clientprotocol/data_pb2.py:28: DeprecationWarning: Call to deprecated create function EnumDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.
  _ATTRIBUTE = _descriptor.EnumDescriptor(
/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/s2clientprotocol/data_pb2.py:168: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.
  _descriptor.FieldDescriptor(
/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/s2clientprotocol/data_pb2.py:161: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.
  _ABILITYDATA = _descriptor.Descriptor(
 Map 3m Algo mast Exp check updates 0/625 episodes, total num timesteps 16000/10000000.0, FPS 753.
incre win rate is 0.0.
/home/hyunwoo/바탕화면/multi-agent/onpolicy/envs/starcraft2/StarCraft2_Env.py:462: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  actions_int = [int(a) for a in actions]
eval win rate is 0.625.
 Map 3m Algo mast Exp check updates 5/625 episodes, total num timesteps 96000/10000000.0, FPS 1358.
incre win rate is 0.0.
 Map 3m Algo mast Exp check updates 10/625 episodes, total num timesteps 176000/10000000.0, FPS 1568.
incre win rate is 0.0043799616753353405.
 Map 3m Algo mast Exp check updates 15/625 episodes, total num timesteps 256000/10000000.0, FPS 1668.
incre win rate is 0.10810810810810811.
 Map 3m Algo mast Exp check updates 20/625 episodes, total num timesteps 336000/10000000.0, FPS 1726.
incre win rate is 0.36079632465543643.
 Map 3m Algo mast Exp check updates 25/625 episodes, total num timesteps 416000/10000000.0, FPS 1768.
incre win rate is 0.5877137428752375.
eval win rate is 0.78125.
 Map 3m Algo mast Exp check updates 30/625 episodes, total num timesteps 496000/10000000.0, FPS 1778.
incre win rate is 0.6738156209987196.
 Map 3m Algo mast Exp check updates 35/625 episodes, total num timesteps 576000/10000000.0, FPS 1801.
incre win rate is 0.7286797220467467.
 Map 3m Algo mast Exp check updates 40/625 episodes, total num timesteps 656000/10000000.0, FPS 1818.
incre win rate is 0.8172009864364982.
 Map 3m Algo mast Exp check updates 45/625 episodes, total num timesteps 736000/10000000.0, FPS 1831.
incre win rate is 0.8599700149925037.
 Map 3m Algo mast Exp check updates 50/625 episodes, total num timesteps 816000/10000000.0, FPS 1841.
incre win rate is 0.9112339930151339.
eval win rate is 0.96875.
 Map 3m Algo mast Exp check updates 55/625 episodes, total num timesteps 896000/10000000.0, FPS 1839.
incre win rate is 0.9362857142857143.
 Map 3m Algo mast Exp check updates 60/625 episodes, total num timesteps 976000/10000000.0, FPS 1845.
incre win rate is 0.9475920679886686.
 Map 3m Algo mast Exp check updates 65/625 episodes, total num timesteps 1056000/10000000.0, FPS 1846.
incre win rate is 0.9577777777777777.
 Map 3m Algo mast Exp check updates 70/625 episodes, total num timesteps 1136000/10000000.0, FPS 1847.
incre win rate is 0.9717421124828532.
 Map 3m Algo mast Exp check updates 75/625 episodes, total num timesteps 1216000/10000000.0, FPS 1851.
incre win rate is 0.9746014590651175.
eval win rate is 1.0.
 Map 3m Algo mast Exp check updates 80/625 episodes, total num timesteps 1296000/10000000.0, FPS 1848.
incre win rate is 0.9719401389631214.
 Map 3m Algo mast Exp check updates 85/625 episodes, total num timesteps 1376000/10000000.0, FPS 1851.
incre win rate is 0.9788973885518333.
 Map 3m Algo mast Exp check updates 90/625 episodes, total num timesteps 1456000/10000000.0, FPS 1851.
incre win rate is 0.9808190772420944.
 Map 3m Algo mast Exp check updates 95/625 episodes, total num timesteps 1536000/10000000.0, FPS 1853.
incre win rate is 0.9757481940144479.
 Map 3m Algo mast Exp check updates 100/625 episodes, total num timesteps 1616000/10000000.0, FPS 1853.
incre win rate is 0.9744963019637848.
eval win rate is 1.0.
 Map 3m Algo mast Exp check updates 105/625 episodes, total num timesteps 1696000/10000000.0, FPS 1849.
incre win rate is 0.9716168271667511.
Traceback (most recent call last):
  File "/home/hyunwoo/바탕화면/multi-agent/onpolicy/train_smac.py", line 143, in <module>
    main(args=sys.argv[1:])
  File "/home/hyunwoo/바탕화면/multi-agent/onpolicy/train_smac.py", line 137, in main
    runner.run()
  File "/home/hyunwoo/바탕화면/multi-agent/onpolicy/runner/shared/smac_runner.py", line 44, in run
    train_infos = self.train()
                  ^^^^^^^^^^^^
  File "/home/hyunwoo/바탕화면/multi-agent/onpolicy/runner/shared/base_runner.py", line 188, in train
    train_infos = self.trainer.train(self.buffer)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hyunwoo/바탕화면/multi-agent/onpolicy/algorithms/mast/mast.py", line 199, in train
    value_loss, policy_loss, dist_entropy, grad_norm, imp_weights = self.network_update(sample)
                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hyunwoo/바탕화면/multi-agent/onpolicy/algorithms/mast/mast.py", line 118, in network_update
    values, action_log_probs, dist_entropy = self.policy.evaluate_actions(
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hyunwoo/바탕화면/multi-agent/onpolicy/algorithms/mast/algorithm/MastPolicy.py", line 66, in evaluate_actions
    values, action_log_probs, dist_entropy = self.model.evaluate_actions(
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hyunwoo/바탕화면/multi-agent/onpolicy/algorithms/mast/algorithm/setransformer.py", line 237, in evaluate_actions
    action_log_probs, dist_entropy = self.encoder.act_layer.evaluate_actions(
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hyunwoo/바탕화면/multi-agent/onpolicy/algorithms/utils/act.py", line 171, in evaluate_actions
    action_logits = self.action_out(x, available_actions)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hyunwoo/바탕화면/multi-agent/onpolicy/algorithms/utils/distributions.py", line 68, in forward
    return FixedCategorical(logits=x)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/torch/distributions/categorical.py", line 71, in __init__
    super().__init__(batch_shape, validate_args=validate_args)
  File "/home/hyunwoo/miniconda3/envs/smac/lib/python3.11/site-packages/torch/distributions/distribution.py", line 69, in __init__
    if not valid.all():
KeyboardInterrupt